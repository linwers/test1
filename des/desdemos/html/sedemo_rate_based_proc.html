
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   <!--
This HTML is auto-generated from an M-file.
To make changes, update the M-file and republish this document.
      --><title>Rate-Based Shared Processor</title><meta name="generator" content="MATLAB 7.10"><meta name="date" content="2010-01-05"><meta name="m-file" content="sedemo_rate_based_proc"><link rel="stylesheet" type="text/css" href="../../../matlab/demos/private/style.css"></head><body><div class="header"><div class="left">sedemo_rate_based_proc.mdl</div><div class="right"><a href="matlab:sedemo_rate_based_proc">Open this model</a></div></div><div class="content"><h1>Rate-Based Shared Processor</h1><!--introduction--><!--/introduction--><h2>Contents</h2><div><ul><li><a href="#1">Overview</a></li><li><a href="#3">Structure of the Model</a></li><li><a href="#5">Rate-Based Shared Processor Subsystem</a></li><li><a href="#8">Results and Displays</a></li><li><a href="#12">Behavior of Processor Under a Heavy Load</a></li><li><a href="#18">Experimenting with the Model</a></li><li><a href="#19">Related Demos</a></li></ul></div><h2>Overview<a name="1"></a></h2><p>This model illustrates one way to simulate a processor that works on multiple tasks by dividing its resources among them. In this model, the processing rate for each task changes based on the number of tasks being processed.</p><h2>Structure of the Model<a name="3"></a></h2><pre class="codeoutput">Warning: The behavior of the #pe signal in the &lt;a
href="matlab:hilite_system('sedemo_rate_based_proc/Rate-Based  Shared
Processor/Shared Processor','find')"&gt;sedemo_rate_based_proc/Rate-Based
Shared Processor/Shared Processor&lt;/a&gt; block has changed.  For details, see
the &lt;a
href="matlab:helpview(fullfile(docroot,'toolbox','simevents','helptargets.map'),'num_pe_change_r2010a');"&gt;R2010a
section&lt;/a&gt; of the SimEvents Release Notes.  &lt;a
href="matlab:setpref('simevents_firstuse','NumberPendingEntitiesDefinitionChange','off')"&gt;Click
here&lt;/a&gt; if you do not want to see this message again. 
</pre><img vspace="5" hspace="5" src="sedemo_rate_based_proc_01.png" alt=""> <p>At the top level of the model, the Task Generator and Intergeneration Time blocks simulate the tasks that arrive at the shared processor. The amount of work or size of a task is set to 1 in the Set Task Size block. A new task waits in the FIFO Queue block until the Rate-Based Shared Processor subsystem can process the task.</p><h2>Rate-Based Shared Processor Subsystem<a name="5"></a></h2><p>The Rate-Based Shared Processor subsystem accepts tasks up to the capacity of the processor. Processor capacity, defined in the block labeled Shared Processor, is the maximum number of tasks the processor can work on in parallel.</p><img vspace="5" hspace="5" src="sedemo_rate_based_proc_02.png" alt=""> <p>Upon the arrival of a new task or the departure of a completed task, the Scheduler subsystem recomputes the residual processing time for each task. Since the rated-based processor divides its resources equally among tasks, if there are two tasks in progress, the residual processing time for a task will be twice as long as the amount of unfinished work for that task. If there are three tasks, the residual processing time will be three times as long and so on.</p><p>In this model, completion of a task is modeled using timeout events. When a task arrives at or departs from the Shared Processor block, the residual processing time is recomputed for each task in the Shared Processor. Blocks labeled Start Timer and Read Timer record how much time has elapsed for each task. This permits calculation of the amount of work the processor has completed since the last rescheduling. The work completed is used by the subsystem labeled Recompute Processing Time (in the Scheduler subsystem) to compute the amount of remaining work and residual processing time. This result is used by the Schedule Timeout block to reschedule the timeout event for the task.</p><h2>Results and Displays<a name="8"></a></h2><p>The model displays these scopes to demonstrate the behavior of the processor:</p><div><ul><li>Number of tasks generated by the Task Generator</li><li>Number of tasks waiting in the FIFO Queue</li><li>Number of tasks being processed at the shared processor</li><li>Processing time of a completed task</li></ul></div><p>The figures below illustrate the number of tasks being processed at the shared processor, and the processing time of a completed task during a simulation run. In this simulation, the intergeneration time of tasks is a random variable that is uniformly distributed between 0 and 2.4 second; the size of a task is 1 second; the capacity of the processor is 5.</p><pre class="codeoutput">Warning: The behavior of the #pe signal in the &lt;a
href="matlab:hilite_system('sedemo_rate_based_proc/Rate-Based  Shared
Processor/Shared Processor','find')"&gt;sedemo_rate_based_proc/Rate-Based
Shared Processor/Shared Processor&lt;/a&gt; block has changed.  For details, see
the &lt;a
href="matlab:helpview(fullfile(docroot,'toolbox','simevents','helptargets.map'),'num_pe_change_r2010a');"&gt;R2010a
section&lt;/a&gt; of the SimEvents Release Notes.  &lt;a
href="matlab:setpref('simevents_firstuse','NumberPendingEntitiesDefinitionChange','off')"&gt;Click
here&lt;/a&gt; if you do not want to see this message again. 
</pre><img vspace="5" hspace="5" src="sedemo_rate_based_proc_03.png" alt=""> <img vspace="5" hspace="5" src="sedemo_rate_based_proc_04.png" alt=""> <p>A comparison of the figure labeled Number of Tasks Being Processed and figure labeled Task Processing Time reveals that a large number of simultaneous tasks causes the processor to take longer to finish each one. For example, between simulation time 15 and 25, the load of the processor is at a peak -- there are usually 4 tasks in the processor. The processing time of departing tasks is also longer, nearly 4 times the size of a task. This is a natural result of rate-based multitasking.</p><h2>Behavior of Processor Under a Heavy Load<a name="12"></a></h2><p>One way to see the processor's behavior when the number of arriving tasks exceeds the processor's capacity is to use a deterministic task arrival process, as follows:</p><div><ul><li>From 0 to 10 seconds -- 1 task arrives at the beginning of every second.</li><li>From 10 to 20 seconds -- 2 tasks arrive at the beginning of every 2 seconds.</li><li>From 20 to 32 seconds -- 3 tasks arrive at the beginning of every 3 seconds.</li><li>From 32 to 44 seconds -- 4 tasks arrive at the beginning of every 4 seconds.</li><li>From 44 to 59 seconds -- 5 tasks arrive at the beginning of every 5 seconds.</li><li>From 59 to 71 seconds -- 6 tasks arrive at the beginning of every 6 seconds.</li><li>From 71 to 85 seconds -- 7 tasks arrive at the beginning of every 7 seconds.</li></ul></div><p>The figures below illustrate the number of tasks generated, the number of tasks waiting for service, the number of tasks being processed at the shared processor as well as the processing time of a completed task during a simulation run using the above arrival schedule. In this simulation, processor capacity is 4.</p><pre class="codeoutput">Warning: The behavior of the #pe signal in the &lt;a
href="matlab:hilite_system('sedemo_rate_based_proc/Rate-Based  Shared
Processor/Shared Processor','find')"&gt;sedemo_rate_based_proc/Rate-Based
Shared Processor/Shared Processor&lt;/a&gt; block has changed.  For details, see
the &lt;a
href="matlab:helpview(fullfile(docroot,'toolbox','simevents','helptargets.map'),'num_pe_change_r2010a');"&gt;R2010a
section&lt;/a&gt; of the SimEvents Release Notes.  &lt;a
href="matlab:setpref('simevents_firstuse','NumberPendingEntitiesDefinitionChange','off')"&gt;Click
here&lt;/a&gt; if you do not want to see this message again. 
Warning: The behavior of the #pe signal in the &lt;a
href="matlab:hilite_system('sedemo_rate_based_proc/Rate-Based  Shared
Processor/Shared Processor','find')"&gt;sedemo_rate_based_proc/Rate-Based
Shared Processor/Shared Processor&lt;/a&gt; block has changed.  For details, see
the &lt;a
href="matlab:helpview(fullfile(docroot,'toolbox','simevents','helptargets.map'),'num_pe_change_r2010a');"&gt;R2010a
section&lt;/a&gt; of the SimEvents Release Notes.  &lt;a
href="matlab:setpref('simevents_firstuse','NumberPendingEntitiesDefinitionChange','off')"&gt;Click
here&lt;/a&gt; if you do not want to see this message again. 
</pre><img vspace="5" hspace="5" src="sedemo_rate_based_proc_05.png" alt=""> <img vspace="5" hspace="5" src="sedemo_rate_based_proc_06.png" alt=""> <img vspace="5" hspace="5" src="sedemo_rate_based_proc_07.png" alt=""> <img vspace="5" hspace="5" src="sedemo_rate_based_proc_08.png" alt=""> <p>In the task arrival schedule, 5 tasks arrive at time 44, 1 more than the processor's capacity. This causes the last arriving task to wait in the FIFO queue (see the figure labeled Number of Tasks Waiting for Service). The task waits in the queue until it is accepted by the processor at time 48 when 4 tasks complete their service and depart from the processor. Since the new task is the only task in the processor, it finishes service in 1 second and departs at time 49. You can observe similar service patterns at time 63 (when 2 pending tasks start service) and at time 75 (when 3 pending tasks start service).</p><h2>Experimenting with the Model<a name="18"></a></h2><div><ul><li>Change the size of tasks by changing the <b>Value</b> parameter for the attribute <tt>ResidualWork</tt> in the Set Task Size block.</li><li>Change the interarrival time of tasks by changing the <b>Vector of output values</b> parameter in the Intergeneration Time block.</li><li>Change the processor capacity by changing the <b>Number of servers</b> parameter in the block labeled Shared Processor in the Rate-Based Shared Processor subsystem. Specify an integer greater than or equal to 2.</li></ul></div><h2>Related Demos<a name="19"></a></h2><div><ul><li><a href="matlab:showdemo('sedemo_shared_proc');">Processor Sharing Via Time Slicing</a></li><li><a href="matlab:showdemo('sedemo_rtos_application');">Operating System with Prioritized Task Execution</a></li></ul></div><p class="footer">Copyright 2005-2008 The MathWorks, Inc.<br>
          Published with MATLAB&reg; 7.10</p><p class="footer" id="trademarks">MATLAB and Simulink are registered trademarks of The MathWorks, Inc.  Please see <a href="http://www.mathworks.com/trademarks">www.mathworks.com/trademarks</a> for a list of other trademarks owned by The MathWorks, Inc.  Other product or brand names are trademarks or registered trademarks of their respective owners.</p></div><!--
##### SOURCE BEGIN #####
%% Rate-Based Shared Processor
%
%% Overview
%
% This model illustrates one way to simulate a processor that works on
% multiple tasks by dividing its resources among them. In this model, the
% processing rate for each task changes based on the number of tasks being
% processed.
%
% Copyright 2005-2008 The MathWorks, Inc.
% $Revision: 1.1.6.3 $ $Date: 2009/11/13 04:15:40 $
%%
model = 'sedemo_rate_based_proc';

subsystem1 = [model '/Rate-Based ' sprintf('\n') 'Shared Processor'];
subsystem2 = [subsystem1 '/Scheduler/Scheduler for Task Departure'];
subsystem3 = [subsystem1 '/Scheduler/Scheduler for Task Arrival'];

inter_gen_time  = [model '/Intergeneration' sprintf('\n') 'Time'];
multi_processor = [subsystem1 '/Shared Processor'];

scope_num_generated     = [model '/Number of Tasks ' sprintf('\n') 'Generated'];
scope_num_in_q          = [model '/Number of Tasks ' sprintf('\n') 'in Queue'];
scope_num_processing    = [subsystem1 '/Number of ' sprintf('\n') 'tasks processing'];
scope_processing_time   = [subsystem1 '/Task Processing Time'];

%% Structure of the Model
open_system(model);

set_param(scope_num_generated,'OpenScopeAtSimStart','off');
set_param(scope_num_in_q,'OpenScopeAtSimStart','off');
set_param(scope_num_processing,'OpenScopeAtSimStart','off');
set_param(scope_processing_time,'OpenScopeAtSimStart','off');
%%
% At the top level of the model, the Task Generator and Intergeneration
% Time blocks simulate the tasks that arrive at the shared processor. The
% amount of work or size of a task is set to 1 in the Set Task Size block.
% A new task waits in the FIFO Queue block until the Rate-Based Shared
% Processor subsystem can process the task.
%
%% Rate-Based Shared Processor Subsystem
%
% The Rate-Based Shared Processor subsystem accepts tasks up to the
% capacity of the processor. Processor capacity, defined in the block
% labeled Shared Processor, is the maximum number of tasks the processor
% can work on in parallel.
%
open_system(subsystem1);
%%
% Upon the arrival of a new task or the departure of a completed task, the
% Scheduler subsystem recomputes the residual processing time for each
% task. Since the rated-based processor divides its resources equally among
% tasks, if there are two tasks in progress, the residual processing time
% for a task will be twice as long as the amount of unfinished work for
% that task. If there are three tasks, the residual processing time will be
% three times as long and so on.
%
%%
% In this model, completion of a task is modeled using timeout events. When
% a task arrives at or departs from the Shared Processor block, the
% residual processing time is recomputed for each task in the Shared
% Processor. Blocks labeled Start Timer and Read Timer record how much time
% has elapsed for each task. This permits calculation of the amount of work
% the processor has completed since the last rescheduling. The work
% completed is used by the subsystem labeled Recompute Processing Time (in
% the Scheduler subsystem) to compute the amount of remaining work and
% residual processing time. This result is used by the Schedule Timeout
% block to reschedule the timeout event for the task.
%
%% Results and Displays
%
% The model displays these scopes to demonstrate the behavior of the
% processor:
%
% * Number of tasks generated by the Task Generator 
% * Number of tasks waiting in the FIFO Queue
% * Number of tasks being processed at the shared processor 
% * Processing time of a completed task
% 
% The figures below illustrate the number of tasks being processed at the
% shared processor, and the processing time of a completed task during a
% simulation run. In this simulation, the intergeneration time of tasks is
% a random variable that is uniformly distributed between 0 and 2.4 second;
% the size of a task is 1 second; the capacity of the processor is 5.
%
%%
close_system(subsystem1);

rand('twister',54321);
set_param(inter_gen_time,'VectorOutputValues','rand(1,85)*2.4');
set_param(multi_processor,'NumberOfServers','5');

sim(model);

sedemo_helper(scope_num_processing,'OpenFig');
%%
sedemo_helper(scope_num_processing,'CloseFig');
sedemo_helper(scope_processing_time,'OpenFig');
%%
% A comparison of the figure labeled Number of Tasks Being Processed and
% figure labeled Task Processing Time reveals that a large number of
% simultaneous tasks causes the processor to take longer to finish each
% one. For example, between simulation time 15 and 25, the load of the
% processor is at a peak REPLACE_WITH_DASH_DASH there are usually 4 tasks in the processor. The
% processing time of departing tasks is also longer, nearly 4 times the
% size of a task. This is a natural result of rate-based multitasking.
%
%% Behavior of Processor Under a Heavy Load
%
% One way to see the processor's behavior when the number of arriving tasks
% exceeds the processor's capacity is to use a deterministic task arrival
% process, as follows:
%
% * From 0 to 10 seconds REPLACE_WITH_DASH_DASH 1 task arrives at the beginning of every second.
% * From 10 to 20 seconds REPLACE_WITH_DASH_DASH 2 tasks arrive at the beginning of every 2
% seconds.
% * From 20 to 32 seconds REPLACE_WITH_DASH_DASH 3 tasks arrive at the beginning of every 3
% seconds.
% * From 32 to 44 seconds REPLACE_WITH_DASH_DASH 4 tasks arrive at the beginning of every 4
% seconds.
% * From 44 to 59 seconds REPLACE_WITH_DASH_DASH 5 tasks arrive at the beginning of every 5
% seconds.
% * From 59 to 71 seconds REPLACE_WITH_DASH_DASH 6 tasks arrive at the beginning of every 6
% seconds.
% * From 71 to 85 seconds REPLACE_WITH_DASH_DASH 7 tasks arrive at the beginning of every 7
% seconds.
%
% The figures below illustrate the number of tasks generated, the number of
% tasks waiting for service, the number of tasks being processed at the
% shared processor as well as the processing time of a completed task
% during a simulation run using the above arrival schedule. In this
% simulation, processor capacity is 4.
%%
sedemo_helper(scope_processing_time,'CloseFig');

schedule = ['[repmat(1.001,1,10)'...
            ' repmat([0.001 2],1,5)'...
            ' repmat([0.001 0.001 3],1,4)'...
            ' repmat([0.001 0.001 0.001 4],1,3)'...
            ' repmat([0.001 0.001 0.001 0.001 5],1,3)'...
            ' repmat([0.001 0.001 0.001 0.001 0.001 6],1,2)'...
            ' repmat([0.001 0.001 0.001 0.001 0.001 0.001 7],1,2)].'''];
set_param(inter_gen_time,'VectorOutputValues',schedule);
set_param(multi_processor,'NumberOfServers','4');
set_param(scope_num_processing,'AxisGrid','off')

sim(model);

sedemo_helper(scope_num_generated,'OpenFig');
%%
sedemo_helper(scope_num_generated,'CloseFig');
sedemo_helper(scope_num_in_q,'OpenFig');
%%
sedemo_helper(scope_num_in_q,'CloseFig');
sedemo_helper(scope_num_processing,'OpenFig');
%%
sedemo_helper(scope_num_processing,'CloseFig');
sedemo_helper(scope_processing_time,'OpenFig');
%%
% In the task arrival schedule, 5 tasks arrive at time 44, 1 more than the
% processor's capacity. This causes the last arriving task to wait in the
% FIFO queue (see the figure labeled Number of Tasks Waiting for Service).
% The task waits in the queue until it is accepted by the processor at time
% 48 when 4 tasks complete their service and depart from the processor.
% Since the new task is the only task in the processor, it finishes service
% in 1 second and departs at time 49. You can observe similar service
% patterns at time 63 (when 2 pending tasks start service) and at time 75
% (when 3 pending tasks start service).
%
%% Experimenting with the Model
% * Change the size of tasks by changing the *Value* parameter for the
% attribute |ResidualWork| in the Set Task Size block.
% * Change the interarrival time of tasks by changing the *Vector of output
% values* parameter in the Intergeneration Time block.
% * Change the processor capacity by changing the *Number of servers*
% parameter in the block labeled Shared Processor in the Rate-Based Shared
% Processor subsystem. Specify an integer greater than or equal to 2.
%
%% Related Demos
%
% * <matlab:showdemo('sedemo_shared_proc'); Processor Sharing Via Time Slicing>
% * <matlab:showdemo('sedemo_rtos_application'); Operating System with Prioritized Task Execution>
%%
bdclose(model);
clear model subsystem1 subsystem2 subsystem3 inter_gen_time multi_processor scope_num_generated scope_num_in_q scope_num_processing scope_processing_time schedule;

displayEndOfDemoMessage(mfilename)
##### SOURCE END #####
--></body></html>